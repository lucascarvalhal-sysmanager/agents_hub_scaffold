$schema: "http://json-schema.org/draft-07/schema#"
title: "Agent Configuration Schema"
type: object
required:
  - tools
  - type
  - agent
properties:
  tools:
    type: array
    items:
      type: object
      required:
        - name
        - transport
      properties:
        name:
          type: string
        transport:
          type: string
          enum: [sse, stdio, streamable, pre_built]
        # Propriedades para pre_built
        kind:
          type: string
        provider:
          type: string
        connection_config:
          type: object
          additionalProperties: true
        params:
          type: object
          additionalProperties: true
      allOf:
        - if:
            properties:
              transport:
                const: sse
          then:
            required: [url]
            properties:
              url:
                type: string
                format: uri
        - if:
            properties:
              transport:
                const: streamable
          then:
            required: [url]
            properties:
              url:
                type: string
                format: uri
              headers:
                type: object
                additionalProperties:
                  type: string
        - if:
            properties:
              transport:
                const: stdio
          then:
            required: [command]
            properties:
              command:
                type: string
              args:
                type: array
                items:
                  type: string
              env:
                type: object
                minProperties: 1
                additionalProperties:
                  type: string
              tool_filter:
                type: array
                items:
                  type: string
        - if:
            properties:
              transport:
                const: pre_built
          then:
            required: [kind]
      additionalProperties: true

  type:
    type: string
    enum: [single, hierarchical, sequential, loop]

  agent:
    $ref: "#/definitions/agent"

definitions:
  agent:
    type: object
    required: [name, model, description, instruction]
    properties:
      name:
        type: string
      model:
        type: string
      description:
        type: string
      instruction:
        type: string
      tools:
        type: array
        items:
          type: string
      agents:
        type: array
        items:
          $ref: "#/definitions/agent"
    additionalProperties: true

additionalProperties: false
